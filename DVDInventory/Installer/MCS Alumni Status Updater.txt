---Properties---
Assembly name:
MCS Alumni Status Update

Root namespace:
MCS_Alumni_Setup

Icon:
MCS Logo.ico

---Form1 Design---
Title: Update Setup - Massillon Christian School Alumni Status
Icon: MCS Logo.ico

Label1 Text: MCS Alumni Status Update Installer...
Label4 Text:

   MCS Alumni Status allows you to share your information with other MCS Alumni members in a way that has never been done before!  And, with new features you can stay in touch with classmates and those blast from the past easier than before!

---Form1 Coding---
Form1_Load
If IO.File.Exists(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\setup.exe") Then
            Try
                IO.File.Move(Application.StartupPath & "\credentials.MCSAS", My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\credentials.MCSAS")
                IO.File.Move(Application.StartupPath & "\Directory.MCSAS", My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\Directory.MCSAS")
                IO.File.Copy(Application.StartupPath & "\MCS Logo.ico", My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Logo.ico")
            Catch
            End Try
        End If
        Try
            My.Computer.FileSystem.DeleteDirectory(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\Application Files", FileIO.DeleteDirectoryOption.DeleteAllContents)
            IO.File.Delete(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Alumni Status.application")
        Catch
        End Try
        Dim RM As Resources.ResourceManager
        Dim B() As Byte
        RM = New Resources.ResourceManager("MCS_Alumni_Setup.Resources", System.Reflection.Assembly.GetExecutingAssembly)
        B = RM.GetObject("ICSharpCode_SharpZipLib")
        If IO.File.Exists(Application.StartupPath & "/ICSharpCode_SharpZipLib.dll") Then
            IO.File.Delete(Application.StartupPath & "/ICSharpCode_SharpZipLib.dll")
            System.IO.File.WriteAllBytes(Application.StartupPath & "/ICSharpCode_SharpZipLib.dll", B)
        Else
            System.IO.File.WriteAllBytes(Application.StartupPath & "/ICSharpCode_SharpZipLib.dll", B)
        End If

Button1_Click
Dim process() As Process = System.Diagnostics.Process.GetProcessesByName("explorer")
        For Each proc In process
            proc.Kill()
        Next
        If IO.File.Exists(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Alumni Status.exe") Then
            Dim loc As String : Dim os As OperatingSystem
            os = Environment.OSVersion
            If os.Version.Major > 5 Then
                loc = "C:\Users\" & Environment.UserName & "\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\MCS Alumni Status"
            Else
                loc = "C:\Documents and Settings\" & Environment.UserName & "\Start Menu\Programs\MCS Alumni Status"
            End If
            Try
                IO.File.Delete(My.Computer.FileSystem.SpecialDirectories.Desktop & "\MCS Alumni Status.url")
                My.Computer.FileSystem.DeleteDirectory(loc, FileIO.DeleteDirectoryOption.DeleteAllContents)
                IO.File.Delete(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Alumni Status.exe")
                IO.File.Delete(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Logo.ico")
                IO.File.Delete(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\Uns.vbs")
            Catch
            End Try
        End If
        Me.Hide()
        Form2.Show()

Button2_Click
MsgBox("If you do not update now, then the next time you use" & vbNewLine _
                 & "[MCS Alumni Status] you will not be able to use previous versions." & vbNewLine & vbNewLine _
                 & "This ensures that you have the best quality security, functionality, and performance.", MsgBoxStyle.Exclamation, "MCS Alumni Update: Warning - you may want to update now!")
        If MsgBox("Are you sure you want to Cancel MCS Alumni Setup?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
            IO.Directory.CreateDirectory(My.Computer.FileSystem.SpecialDirectories.Desktop & "\MCS Alumni Status Update Install")
            IO.File.Copy(Application.StartupPath & "\MCS Alumni Status Setup.exe", My.Computer.FileSystem.SpecialDirectories.Desktop & "\MCS Alumni Status Update Install\MCS Alumni Status Setup.exe")
            IO.File.Copy(Application.StartupPath & "\ICSharpCode.SharpZipLib.dll", My.Computer.FileSystem.SpecialDirectories.Desktop & "\MCS Alumni Status Update Install\ICSharpCode.SharpZipLib.dll")
            MsgBox("A folder has been created to your Desktop titled [MCS Alumni Status Update Install]," & vbNewLine _
                 & "so you can Update later.")
            End
        End If

---Form2 Design---
Label1 Text: MCS Alumni Status Installation in Progress...
Label2 Text:

       Thank you for Installing MCS Alumni Status from Davisbros Technologies.
*/* Label3 Text: We hope you enjoy your experience with your fellow alumni members!

---Form2 Coding---
Public Class Form2
    Public ProgName As String = "MCS Alumni Status" : Dim Selfolder As String
    Dim txt, txt1, loc, sysd As String : Dim os As OperatingSystem
    Public Sub Unzip(ByVal Filename As String, ByVal Folder As String)
        Try
            My.Computer.Network.DownloadFile("ftp://Davisbros:geekmen@davis.techdweebs.com/MCSAS/MCS Alumni Status Update.zip", "C:\MCS Alumni Status Update.zip")
        Catch
            Timer.Stop()
            MsgBox("It appears that you have no Internet Connection or our Server is down temporarily!" & vbNewLine & vbNewLine _
  & "Please Connect to the Internet to use [MCS Alumni Status Updater] by the Davis" & vbNewLine & "Brothers, or we will try to fix the issue on our end as soon as possible." & vbNewLine & vbNewLine _
     & "            Thank you for being patient!  - The Davisbros Tech. Team", MsgBoxStyle.Information, "MCS Alumni Status Updater: Unable to Connect to the Network!")
            End
        End Try
        Dim unz As New ICSharpCode.SharpZipLib.Zip.FastZip
        unz.ExtractZip(Filename, My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status", "")
    End Sub
    Public Sub CreateShortcut(ByVal MainExe As String)
        Dim txt As String
        txt = "[InternetShortcut]" & vbNewLine & "URL=" & My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Alumni Status.exe" & vbNewLine &
        "IconIndex=0" & vbNewLine & "IconFile=" & My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Logo.ico"
        Dim ExeName As String = Path.GetFileNameWithoutExtension(MainExe)
        Dim objWriter As New StreamWriter(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\" & ExeName & ".url")
        objWriter.Write(txt)
        objWriter.Close()
    End Sub
    Public Sub CreateUninstaller()
        Directory.CreateDirectory(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status")
        os = Environment.OSVersion
        If os.Version.Major > 5 Then
            loc = "C:\Users\" & Environment.UserName & "\AppData\Roaming\Microsoft\Windows\StartMenu\Programs\" & ProgName
        Else
            loc = "C:\Documents and Settings\" & Environment.UserName & "\Start Menu\Programs\" & ProgName
        End If
        txt = My.Settings.Bat
        txt = Replace(txt, "FOLDERLOC1", My.Computer.FileSystem.SpecialDirectories.ProgramFiles)
        txt1 = My.Settings.Vbs
        txt1 = Replace(txt1, "PROGNAME", ProgName)
        txt1 = Replace(txt1, "FOLDERLOC1", My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status")
        txt1 = Replace(txt1, "FOLDERLOC2", loc)
        If Form1.CheckBox2.Checked Then
            txt1 = Replace(txt1, "FOLDERLOC3", My.Computer.FileSystem.SpecialDirectories.Desktop & "\" & ProgName & ".url")
        Else
            txt1 = Replace(txt1, "FOLDERLOC3", "")
            txt1 = Replace(txt1, "set demofile = filesys3.GetFile" & "("""")", "")
            txt1 = Replace(txt1, "demofile.Delete", "")
        End If
        If IO.File.Exists(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\setup.exe") Then
            txt1 = Replace(txt1, "FOLDERLOC5", Application.StartupPath)
        Else
            txt1 = Replace(txt1, "FOLDERLOC5", "")
            txt1 = Replace(txt1, "set demofolder3 = filesys2.GetFolder" & "("""")", "")
            txt1 = Replace(txt1, "demofolder3.Delete", "")
        End If
        txt1 = Replace(txt1, "FOLDERLOC4", My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\" & "Uns.vbs")
        Dim objWriter As New StreamWriter(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\" & "UnInstall.bat")
        Dim objWriter1 As New StreamWriter(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\" & "Uns.vbs")
        objWriter.Write(txt)
        objWriter1.Write(txt1)
        objWriter.Close()
        objWriter1.Close()
    End Sub
    Private Sub Timer_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer.Tick
        ProgressBar.Increment(1)
        If ProgressBar.Value = 10 Then
            Label3.Text = "Extracing:" & Selfolder & "\MCS Alumni Status Update"
            Unzip(Selfolder & "\MCS Alumni Status Update.zip", Selfolder)
            My.Computer.FileSystem.DeleteFile(Selfolder & "\MCS Alumni Status Update.zip")
        End If
        If ProgressBar.Value = 15 Then
            Label3.Text = "Creating Uninstaller..."
            CreateUninstaller()
        End If
        os = Environment.OSVersion
        If os.Version.Major > 5 Then
            loc = "C:\Users\" & Environment.UserName & "\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\" & ProgName
        Else
            loc = "C:\Documents and Settings\" & Environment.UserName & "\Start Menu\Programs\" & ProgName
        End If
        If ProgressBar.Value = 25 Then
            Label3.Text = "Installing: " & loc
            CreateShortcut(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Alumni Status.exe")
            Directory.CreateDirectory(loc)
            My.Computer.FileSystem.CopyFile(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Alumni Status.url", loc & "\" & ProgName & ".url")
            File.Copy(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\" & "UnInstall.bat", loc & "\UnInstall.bat")
        End If
        If ProgressBar.Value = 55 Then
            Label3.Text = "Almost done with installation!"
        ElseIf Form1.CheckBox2.Checked Then
            If ProgressBar.Value = 40 Then
                Label3.Text = "Creating Desktop Shortcut"
                Try
                    File.Copy(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Alumni Status.url", My.Computer.FileSystem.SpecialDirectories.Desktop & "\" & ProgName & ".url")
                Catch
                End Try
            End If
        Else
            Try
                File.Delete(My.Computer.FileSystem.SpecialDirectories.Desktop & "\" & ProgName & ".url")
            Catch
            End Try
        End If
        If ProgressBar.Value = 70 Then
            Label3.Text = "Done with Installation of MCS Alumni Status!"
        End If
        If ProgressBar.Value = 80 Then
            Label3.Text = "Starting Davisbros Software!"
        End If
        If ProgressBar.Value = 100 Then
            Timer.Stop()
            If My.Computer.FileSystem.FileExists(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\setup.exe") Then
                Form3.Show()
                Process.Start("appwiz.cpl")
            Else
                Process.Start(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\" & ProgName & "\" & ProgName & ".exe")
                End
            End If
            If IO.Directory.Exists(My.Computer.FileSystem.SpecialDirectories.Desktop & "\MCS Alumni Status Update Install") Then
                Try
                    My.Computer.FileSystem.DeleteDirectory(My.Computer.FileSystem.SpecialDirectories.Desktop & "\MCS Alumni Status Update Install", FileIO.DeleteDirectoryOption.DeleteAllContents)
                Catch
                End Try
            End If
        End If
    End Sub
End Class

---Form3 Design---
Title: MCS Alumni Status - UnInstall Information

---Form3 Coding---
Private Sub Form3_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
        RM = New Resources.ResourceManager("MCS_Alumni_Setup.Resources", System.Reflection.Assembly.GetExecutingAssembly)
        PictureBox1.Image = RM.GetObject("MCSAS_UnInstall")
        RM.ReleaseAllResources()
        IO.File.Delete(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\setup.exe")
        If MsgBox("Please UnInstall any Previous Versions of MCS Alumni Status!" & vbNewLine & vbNewLine _
            & "     When your finished close all windows to continue.") = MsgBoxResult.Ok Then
        End If
    End Sub
    Private Sub Form3_FormClosing(sender As Object, e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
        Process.Start(My.Computer.FileSystem.SpecialDirectories.ProgramFiles & "\MCS Alumni Status\MCS Alumni Status.exe")
        End
    End Sub